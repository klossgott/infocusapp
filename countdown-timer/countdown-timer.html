<!-- Front-end: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: transparent;
            color: black;
            text-align: center;
        }
        #timer {
            font-size: 3em;
            margin-top: 20px;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }
        .flashing {
            animation: smoothFlash 0.5s infinite alternate;
        }
        @keyframes smoothFlash {
            0% { color: #ff0000; }
            50% { color: #ff7373; }
            100% { color: #ff0000; }
        }
        .control-button {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            margin: 10px;
            color: black;
        }
    </style>
    <script>
        let timerInterval;
        let isFlashing = false;
        let flashingSpeed = 1000; // Initial flashing speed
        let remainingTime = 0;

        function startCountdown(duration) {
            clearInterval(timerInterval);
            const endDate = new Date().getTime() + duration * 1000;
            isFlashing = false;
            flashingSpeed = 1000;
            document.getElementById('timer').classList.remove('flashing');
            document.getElementById('timer').style.opacity = '1';

            function updateTimer() {
                const now = new Date().getTime();
                const distance = endDate - now;

                if (distance < 0) {
                    document.getElementById('timer').innerHTML = "Time's Up!";
                    document.getElementById('timer').classList.add('flashing');
                    clearInterval(timerInterval);
                    rapidFlash();
                    return;
                }

                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('timer').innerHTML = `${minutes}m ${seconds}s`;

                if (distance < 10000 && !isFlashing) { // Start flashing when less than 10 seconds left
                    isFlashing = true;
                    flashingSpeed = 500;
                    document.getElementById('timer').classList.add('flashing');
                }
            }

            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
        }

        function rapidFlash() {
            setInterval(() => {
                document.getElementById('timer').style.visibility = document.getElementById('timer').style.visibility === 'hidden' ? 'visible' : 'hidden';
            }, 100);
        }

        function stopCountdown() {
            clearInterval(timerInterval);
            document.getElementById('timer').classList.remove('flashing');
            document.getElementById('timer').style.visibility = 'visible';
        }

        function resetCountdown() {
            clearInterval(timerInterval);
            document.getElementById('timer').innerHTML = "0m 0s";
            document.getElementById('timer').classList.remove('flashing');
            document.getElementById('timer').style.visibility = 'visible';
            document.getElementById('timer').style.opacity = '1';
        }

        function setCountdown() {
            const minutes = parseInt(document.getElementById('countdownInput').value, 10);
            if (!isNaN(minutes)) {
                startCountdown(minutes * 60);
            } else {
                alert("Please enter a valid number of minutes.");
            }
        }

        function pauseCountdown() {
            clearInterval(timerInterval);
            const timerText = document.getElementById('timer').innerHTML.split(' ');
            const minutes = parseInt(timerText[0], 10);
            const seconds = parseInt(timerText[1], 10);
            remainingTime = (minutes * 60) + seconds;
        }

        function resumeCountdown() {
            if (remainingTime > 0) {
                startCountdown(remainingTime);
            }
        }

        window.onload = function() {
            document.getElementById('timer').style.opacity = '1';
            document.getElementById('startButton').addEventListener('click', setCountdown);
            document.getElementById('stopButton').addEventListener('click', stopCountdown);
            document.getElementById('resetButton').addEventListener('click', resetCountdown);
            document.getElementById('pauseButton').addEventListener('click', pauseCountdown);
            document.getElementById('resumeButton').addEventListener('click', resumeCountdown);
        };
    </script>
</head>
<body>
    <div id="timer">0m 0s</div>
    <div style="margin-top: 20px;">
        <input type="number" id="countdownInput" placeholder="Enter minutes" min="1" style="text-align: center; border: none; font-size: 1.5em; margin-bottom: 10px;">
        <div>
            <button id="startButton" class="control-button">▶</button>
            <button id="stopButton" class="control-button">■</button>
            <button id="pauseButton" class="control-button">⏸</button>
            <button id="resumeButton" class="control-button">▶</button>
            <button id="resetButton" class="control-button">↺</button>
        </div>
    </div>
</body>
</html>
