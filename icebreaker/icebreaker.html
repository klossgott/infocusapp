<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Icebreaker Widget</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: transparent;
            overflow: hidden;
        }
        #widget-container {
            position: relative;
            width: 320px; /* Adjusted width for 16:9 aspect ratio */
            height: 180px; /* Adjusted height for 16:9 aspect ratio */
            margin: 0 auto;
            background: transparent;
        }
        #widget-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            cursor: pointer;
            display: block;
        }
        #icebreaker-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f8f8f0; /* Off-white background */
            border-radius: 15px;
            display: none;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            animation-duration: 0.5s;
            animation-fill-mode: forwards;
        }
        #icebreaker-text {
            font-family: 'Open Sans', Arial, sans-serif; /* Elegant modern font */
            font-size: 1em;
            color: #333;
            line-height: 1.5;
        }
        /* Animations */
        @keyframes fadeInFlip {
            0% {
                opacity: 0;
                transform: rotateY(90deg);
            }
            100% {
                opacity: 1;
                transform: rotateY(0deg);
            }
        }
        @keyframes fadeOutFlip {
            0% {
                opacity: 1;
                transform: rotateY(0deg);
            }
            100% {
                opacity: 0;
                transform: rotateY(90deg);
            }
        }
    </style>
    <!-- Include Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
</head>
<body>

<div id="widget-container">
    <img id="widget-image" src="ice-cubes.png" alt="Ice Cubes">
    <div id="icebreaker-card">
        <div id="icebreaker-text"></div>
    </div>
</div>

<audio id="ice-sound" src="ice-10-104149.mp3" preload="auto"></audio>

<script>
    const prompts = [
        "What’s the weirdest movie you’ve ever seen?",
        "What’s a pizza topping that most people hate but you secretly love?",
        "Window seat or aisle seat?",
        "What’s the funniest thing you’ve read online recently?",
        "What would be your elevator pitch to aliens for why they should abduct you?",
        "In your opinion, what’s the funniest word in the English language?",
        "What non-dairy item do you think would make a great alternative milk?",
        "What’s your hot take on a very popular movie or TV show?",
        "If you were a sitcom character, what would be your catchphrase?",
        "Who would win in an arm wrestle, you or the person next to you?",
        // ... [Rest of your questions]
        "If you could have an animal as a sidekick, which would you choose?"
    ];

    // Image sources
    const initialImageSrc = "ice-cubes.png";
    const hoverImageSrc = "mallet.png";
    const clickImageSrc = "broken-ice.png";

    const widgetImage = document.getElementById('widget-image');
    const icebreakerCard = document.getElementById('icebreaker-card');
    const icebreakerText = document.getElementById('icebreaker-text');
    const iceSound = document.getElementById('ice-sound');

    // Set initial image source
    widgetImage.src = initialImageSrc;

    function getRandomPrompt() {
        const randomIndex = Math.floor(Math.random() * prompts.length);
        return prompts[randomIndex];
    }

    widgetImage.addEventListener('mouseover', () => {
        widgetImage.src = hoverImageSrc;
    });

    widgetImage.addEventListener('mouseout', () => {
        widgetImage.src = initialImageSrc;
    });

    widgetImage.addEventListener('click', () => {
        // Play random portion of the ice sound
        playRandomIceSound();

        // Reduce size of the broken ice image
        widgetImage.src = clickImageSrc;
        widgetImage.style.transform = 'scale(0.5)'; // Reduce size to 50%

        setTimeout(() => {
            widgetImage.style.display = 'none';
            widgetImage.style.transform = 'scale(1)'; // Reset size
            showIcebreaker();
        }, 1500); // Match the delay with the sound duration (1.5 seconds)
    });

    function showIcebreaker() {
        icebreakerText.textContent = getRandomPrompt();
        icebreakerCard.style.display = 'flex';
        icebreakerCard.style.animationName = 'fadeInFlip';
    }

    icebreakerCard.addEventListener('click', () => {
        icebreakerCard.style.animationName = 'fadeOutFlip';
        icebreakerCard.addEventListener('animationend', () => {
            icebreakerCard.style.display = 'none';
            widgetImage.src = initialImageSrc;
            widgetImage.style.display = 'block';
        }, { once: true });
    });

    function playRandomIceSound() {
        const duration = 1.5; // Play 1.5 seconds
        const totalDuration = iceSound.duration;

        if (isNaN(totalDuration) || totalDuration <= duration) {
            iceSound.currentTime = 0;
        } else {
            const maxStartTime = totalDuration - duration;
            const randomStartTime = Math.random() * maxStartTime;
            iceSound.currentTime = randomStartTime;
        }

        iceSound.play();

        // Stop the sound after 1.5 seconds
        setTimeout(() => {
            iceSound.pause();
            iceSound.currentTime = 0;
        }, duration * 1000);
    }

    // Ensure the audio duration is loaded before playing
    iceSound.addEventListener('loadedmetadata', () => {
        // Now the duration is available
    });
</script>

</body>
</html>
