<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Typography Personality Test</title>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- We'll load fonts used for the archetype samples -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Inconsolata&family=Lobster&family=Montserrat:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 500px;
    margin: 0 auto;
  }
  h1, h2, h3 {
    margin-top: 1em;
  }
  .hidden {
    display: none;
  }
  .archetype-sample {
    margin: 15px 0;
    padding: 10px;
    border: 1px solid #ccc;
    text-align: center;
  }
</style>

</head>
<body>

<div id="app">
  <div id="intro" class="hidden">
    <h1>Welcome to the Typography Personality Test</h1>
    <p>No direct input hereâ€”please set a session parameter.</p>
  </div>

  <!-- Session 2: Structural Precision -->
  <div id="session2" class="hidden">
    <h2>Structural Precision</h2>
    <p>Reflect on your journaling exercise from this session. Did you enjoy using guides and neat spacing? Rate how much you value structure and order in your lettering (0-100):</p>
    <input type="range" id="spRange" min="0" max="100" value="50" />
    <span id="spValue">50</span>
    <br><br>
    <button id="saveSP">Save Score</button>
    <p id="spConfirm" class="hidden">Score saved! In the next sessions, you'll add emotional and spontaneous dimensions.</p>
  </div>

  <!-- Session 3: Emotional Expressiveness -->
  <div id="session3" class="hidden">
    <h2>Emotional Expressiveness</h2>
    <p>Think about how easily you expressed feelings through letterforms. Rate your Emotional Expressiveness (0-100):</p>
    <input type="range" id="eeRange" min="0" max="100" value="50" />
    <span id="eeValue">50</span>
    <br><br>
    <button id="saveEE">Save Score</button>
    <p id="eeConfirm" class="hidden">Score saved! Just one more dimension to go.</p>
  </div>

  <!-- Session 4: Creative Spontaneity -->
  <div id="session4" class="hidden">
    <h2>Creative Spontaneity</h2>
    <p>How comfortable were you with improvisation, patterns, and breaking the rules? Rate your Creative Spontaneity (0-100):</p>
    <input type="range" id="csRange" min="0" max="100" value="50" />
    <span id="csValue">50</span>
    <br><br>
    <button id="saveCS">Save Score</button>
    <p id="csConfirm" class="hidden">Score saved! In the next session, you'll discover your archetype.</p>
  </div>

  <!-- Session 5: Archetype Reveal -->
  <div id="session5" class="hidden">
    <h2>Your Typographic Archetype</h2>
    <div id="resultArea"></div>
  </div>
</div>

<script>
  // Utility: Get URL parameter
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  const sessionParam = getQueryParam('session');

  // Hide all sections first
  document.querySelectorAll('#app > div').forEach(div => div.classList.add('hidden'));

  // If no session param, show intro
  if(!sessionParam) {
    document.getElementById('intro').classList.remove('hidden');
  }

  // FUNCTIONS TO CALCULATE ARCHETYPE
  function determineArchetype(SP, EE, CS) {
    // Convert to numbers
    SP = Number(SP);
    EE = Number(EE);
    CS = Number(CS);

    // Archetypes:
    // Serious Serif: High SP, Mod EE, Low CS
    //   Rough thresholds: SP>75, EE<60, CS<25
    // Sassy Sans: Med-High SP, Mod EE, Med CS
    //   Example: SP>60, EE around 40-70, CS 30-60
    // Sweeping Script: Low SP, High EE, High CS
    //   SP<40, EE>70, CS>70
    // Mellow Mono: Med-High SP, Mod-High EE, Med CS
    //   SP>60, EE>60, CS 30-60
    // Zesty Zentangle: Low SP, High EE, High CS (more decorative)
    //   SP<40, EE>70, CS>70 (But different from Sweeping Script?
    //   Let's say Sweeping Script is more emotional line, Zesty is more patterns:
    //   If EE and CS are high, and SP<40, we can differentiate by mid-range of EE and CS?
    //   For simplicity, let's define a simple logic first:
    // We'll pick the best match based on closeness to these patterns rather than strict conditions.

    // We'll do a simple heuristic:
    // Let's define distances to each archetype profile:
    // Archetype profiles (SP,EE,CS) center points:
    const archetypes = [
      {name: 'Serious Serif', sp:90, ee:50, cs:10, font:'Playfair Display', desc:'Structured, traditional, and organized. Prefers timeless forms and subtle elegance.'},
      {name: 'Sassy Sans', sp:70, ee:50, cs:50, font:'Montserrat', desc:'Modern, confident, and straightforward. Embraces clarity and clean lines.'},
      {name: 'Sweeping Script', sp:20, ee:90, cs:90, font:'Dancing Script', desc:'Emotional, fluid, and expressive. Lets feelings flow through every letterform.'},
      {name: 'Mellow Mono', sp:70, ee:70, cs:50, font:'Inconsolata', desc:'Calm, warm, and steady. Enjoys gentle rhythms and subtle emotional cues.'},
      {name: 'Zesty Zentangle', sp:20, ee:90, cs:90, font:'Lobster', desc:'Playful, decorative, and adventurous. Loves patterns, flourishes, and visual surprises.'}
    ];

    // Compute which archetype is closest by Euclidean distance
    let bestMatch = null;
    let bestDist = Infinity;
    for (let arch of archetypes) {
      const dist = Math.sqrt((SP-arch.sp)**2 + (EE-arch.ee)**2 + (CS-arch.cs)**2);
      if(dist < bestDist) {
        bestDist = dist;
        bestMatch = arch;
      }
    }

    return bestMatch;
  }

  // SESSION 2 LOGIC
  if(sessionParam == '2') {
    const sec = document.getElementById('session2');
    sec.classList.remove('hidden');

    const rangeSP = document.getElementById('spRange');
    const spValue = document.getElementById('spValue');
    rangeSP.addEventListener('input', ()=> {
      spValue.textContent = rangeSP.value;
    });

    document.getElementById('saveSP').addEventListener('click', ()=> {
      localStorage.setItem('SP', rangeSP.value);
      document.getElementById('spConfirm').classList.remove('hidden');
    });
  }

  // SESSION 3 LOGIC
  if(sessionParam == '3') {
    const sec = document.getElementById('session3');
    sec.classList.remove('hidden');

    const rangeEE = document.getElementById('eeRange');
    const eeValue = document.getElementById('eeValue');
    rangeEE.addEventListener('input', ()=> {
      eeValue.textContent = rangeEE.value;
    });

    document.getElementById('saveEE').addEventListener('click', ()=> {
      localStorage.setItem('EE', rangeEE.value);
      document.getElementById('eeConfirm').classList.remove('hidden');
    });
  }

  // SESSION 4 LOGIC
  if(sessionParam == '4') {
    const sec = document.getElementById('session4');
    sec.classList.remove('hidden');

    const rangeCS = document.getElementById('csRange');
    const csValue = document.getElementById('csValue');
    rangeCS.addEventListener('input', ()=> {
      csValue.textContent = rangeCS.value;
    });

    document.getElementById('saveCS').addEventListener('click', ()=> {
      localStorage.setItem('CS', rangeCS.value);
      document.getElementById('csConfirm').classList.remove('hidden');
    });
  }

  // SESSION 5 LOGIC (Reveal Archetype)
  if(sessionParam == '5') {
    const sec = document.getElementById('session5');
    sec.classList.remove('hidden');

    const SP = localStorage.getItem('SP');
    const EE = localStorage.getItem('EE');
    const CS = localStorage.getItem('CS');
    const resultArea = document.getElementById('resultArea');

    if(SP && EE && CS) {
      const archetype = determineArchetype(SP,EE,CS);
      if(archetype) {
        resultArea.innerHTML = `
          <h3>Your Archetype: ${archetype.name}</h3>
          <p>${archetype.desc}</p>
          <div class="archetype-sample" style="font-family:'${archetype.font}', sans-serif;">
            This is a sample in the style of ${archetype.name}.
          </div>
          <p>SP: ${SP}, EE: ${EE}, CS: ${CS}</p>
          <p>Feel free to revisit your journal activities, using these insights to guide your lettering style!</p>
        `;
      } else {
        resultArea.textContent = "Could not determine archetype. Please ensure all scores are set.";
      }
    } else {
      resultArea.textContent = "You have not completed all dimensions yet. Please go back to sessions 2, 3, and 4.";
    }
  }

</script>
</body>
</html>
